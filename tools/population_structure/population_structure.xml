<tool id="gd_population_structure" name="Ancestry" version="1.0.0">
  <description>: Characterize ancestries w.r.t. inferred ancestral populations</description>
  <command interpreter="python">
    population_structure.py "$input" "${input.extra_files_path}/admix.ped" "$output" "$output.files_path" "$populations"
  </command>
  <inputs>
    <param name="input" type="data" format="gd_ped" label="Dataset" />
    <param name="populations" type="integer" min="1" value="2" label="Number of populations" />
  </inputs>
  <outputs>
    <data name="output" format="html" />
  </outputs>
  <!--
  <tests>
    <test>
      <param name="input" value="fake" ftype="gd_ped" >
        <metadata name="base_name" value="admix" />
        <composite_data value="test_out/prepare_population_structure/prepare_population_structure.html" />
        <composite_data value="test_out/prepare_population_structure/admix.ped" />
        <composite_data value="test_out/prepare_population_structure/admix.map" />
        <edit_attributes type="name" value="fake" />
      </param>
      <param name="populations" value="2" />

      <output name="output" file="test_out/population_structure/population_structure.html" ftype="html" compare="diff" lines_diff="2">
        <extra_files type="file" name="numeric.txt" value="test_out/population_structure/numeric.txt" />
        <extra_files type="file" name="graphical.pdf" value="test_out/population_structure/graphical.pdf" compare="sim_size" delta="1000" />
      </output>
    </test>
  </tests>
  -->
  <help>
**Dataset formats**

The input dataset is in gd_ped_ format.
The output dataset is a composite dataset containing a graph and text.
(`Dataset missing?`_)

.. _gd_ped: ./static/formatHelp.html#gd_ped
.. _Dataset missing?: ./static/formatHelp.html

-----

**What it does**

The user selects a gd_ped dataset generated by the Prepare Input tool,
and specifies a number, K, of ancestral
populations.  The tool estimates the proportion of each individual's ancestry
coming from each ancestral population.  The proportions are shown both as
numbers and graphically.

-----

**Acknowledgments**

We use the program "Admixture", downloaded from

http://www.genetics.ucla.edu/software/admixture/

and described in the paper "Fast model-based estimation of ancestry in
unrelated individuals" by David H. Alexander, John Novembre and Kenneth Lange,
Genome Research 19 (2009), pp. 1655-1664.
  </help>
</tool>
